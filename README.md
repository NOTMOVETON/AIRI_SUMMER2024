# Репозиторий проекта Со-дизайн робота гибридной локомоции летней школы AIRI
### Изначальная идея
Изначально идея заключалась в реализации задачи со-дизайна робота гибридной локомоции (конструкция адаптируется под управление и наоборот), но с учетом реальности выполнения задачи за 5 дней, было принято решение реализовать задачу езды с соответствующей скоростью.


### Шаги реализации
В процессе работы над проектом, мы придерживались следующих шагов:
- Изучение вариантов создания симуляции (MuJoCo, MJX). Остановились на MuJoCo, так как вникать в JAX за очень короткий срок оказалось довольно неприятно.
- Выбор библиотеки с реализацией алгоритмов обучения с подкреплением. (Пробовали использовать самописные - долго и реализация у каждого отличается, что сводит совместную работу на нет). Остановились на stable-baselines3
- Создание среды с агентом, совместимой с выбранной библиотекой, поддержка параллелизации(несколько агентов обучаются одновременно)
- Тестирование разных алгоритмов, с разными модификациями среды (DQN, SAC, PPO). Остановились на PPO, так как позволял работать как с дискретными, так и с непрерывными действиями, а также показал себя лучше чем остальные методы (скорее всего у них просто были неправильно настроены гиперпараметры, но времени у нас было не очень много)
- Тестирование разных вариаций задач. Начали с простого - удержание равновесия и позиции, далее усложняли задачу - удержание желаемой высоты, езда с заданной, езда с заданной линейной и угловой скоростями, езда к точке. В течении каждого из шагов меняли среду, добавляли новое, тестировали, и так пока не заработает.
- Reward-engineering. Много экспериментировали с наградами, вводили разные награды с разным соотношением, тестировали нормирование как наград, так и показаний с робота.


### Результаты
В результате выполнения проекта было обучено огромное множество обученных агентов, большинство из них не могли справиться с поставленной задачей, но некоторые показали относительно рабочий результат. 


Видео с примером работы лучшего полученного агента

[Отчет](https://docs.google.com/document/d/1tdW2XGwlyqLLGHqRc42NOWkJK84U0Exm723ULfpPi38/edit?usp=sharing)
[Презентацию работы](https://docs.google.com/presentation/d/1jtNIakRO1FqaYClxj6sjHEq2X0mII-rKI4AufXIBggU/edit?usp=sharing)
